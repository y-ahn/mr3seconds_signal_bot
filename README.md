# 📈 Mr.3초 신호 감지 시스템 — 파이썬 자동매매 봇

> **책 『Mr.3초 신호 감지 시스템』** 의 파이썬 자동매매 구현 코드입니다.  
> RSI + MACD + 거래량 3지표 조합으로 매수·매도 신호를 자동 감지하고  
> 업비트 API를 통해 자동으로 주문을 실행합니다.

[![Python](https://img.shields.io/badge/Python-3.10%2B-blue)](https://www.python.org/)
[![Upbit API](https://img.shields.io/badge/Upbit-API-orange)](https://docs.upbit.com/)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

---

## 📌 목차

1. [주요 기능](#주요-기능)
2. [파일 구성](#파일-구성)
3. [시스템 요구사항](#시스템-요구사항)
4. [설치 방법](#설치-방법)
5. [업비트 API 키 발급 및 설정](#업비트-api-키-발급-및-설정)
6. [실행 방법](#실행-방법)
7. [사용자 설정 파라미터](#사용자-설정-파라미터)
8. [신호 등급 기준](#신호-등급-기준)
9. [생성 파일 안내](#생성-파일-안내)
10. [주의사항 및 면책 고지](#주의사항-및-면책-고지)

---

## ✅ 주요 기능

- **3지표 자동 계산**: RSI(14) · MACD(12,26,9) · 거래량 비율 실시간 계산
- **신호 등급 자동 판별**: 3종 동시 충족(★★★) / 2종 충족(★★) / 1종 충족(★) 구분
- **업비트 자동 매수**: 3등급 신호 감지 시 자동 주문 실행
- **단계별 자동 익절**: 1차(+15%, 30% 매도) → 2차(+25%, 30% 매도) → 3차(+40%, 50% 매도)
- **ATR 기반 자동 손절**: 진입 시 ATR × 3 손절가 자동 계산 및 자동 매도
- **최대 10개 종목 동시 모니터링**: KRW 마켓 상위 50개 코인 스캔
- **거래 로그 자동 저장**: 모든 신호 및 거래 내역 CSV + 로그 파일 자동 기록

---

## 📁 파일 구성

본 프로젝트는 **단일 파일**로 구성되어 있습니다.

```
mr3seconds_signal_bot/
│
├── mr3seconds_signal_bot.py     # ⭐ 전체 자동매매 코드 (단일 파일)
├── requirements.txt             # 필요 패키지 목록
├── README.md                    # 설치 및 실행 가이드
│
├── mr3seconds_bot.log           # 실행 로그 (자동 생성)
└── mr3seconds_trades.csv        # 거래 내역 (자동 생성)
```

**`mr3seconds_signal_bot.py` 내부 구성**

| 구분 | 함수명 | 설명 |
|------|--------|------|
| 설정 영역 | — | API 키, 지표 파라미터, 리스크 설정 |
| 로그 | `log_trade()` | 거래 이력 CSV + 로그 파일 기록 |
| 데이터 | `get_historical_data()` | 업비트 캔들 데이터 수신 |
| 지표 계산 | `calc_rsi()` | RSI(14) 계산 |
| 지표 계산 | `calc_macd()` | MACD(12,26,9) 계산 |
| 지표 계산 | `calculate_indicators()` | RSI·MACD·거래량·ATR 통합 계산 |
| 신호 감지 | `detect_signal()` | 3등급 신호 판별 (핵심 함수) |
| 주문 관리 | `update_order_amount()` | 잔고 기반 주문 금액 동적 조정 |
| 익절/손절 | `check_profit_targets()` | 단계별 익절·ATR 손절 자동 실행 |
| 메인 루프 | `main()` | 전체 자동매매 실행 루프 |

---

## 💻 시스템 요구사항

| 항목 | 권장 사양 |
|------|-----------|
| 운영체제 | Windows 10/11, macOS 12+, Ubuntu 20.04+ |
| Python 버전 | **3.10 이상** |
| 메모리 | 4GB RAM 이상 |
| 네트워크 | 안정적인 인터넷 연결 필수 |
| 계정 | 업비트 계정 및 API 키 |

---

## 🛠 설치 방법

### Step 1. 저장소 클론

```bash
git clone https://github.com/y-ahn/mr3seconds_signal_bot.git
cd mr3seconds_signal_bot
```

### Step 2. 가상환경 생성 및 활성화

```bash
# 가상환경 생성
python -m venv venv

# 활성화 (Windows)
venv\Scripts\activate

# 활성화 (macOS / Linux)
source venv/bin/activate
```

### Step 3. 필요 패키지 설치

```bash
pip install -r requirements.txt
```

**`requirements.txt` 내용**

```
pyupbit
pandas
numpy
```

---

## 🔑 업비트 API 키 발급 및 설정

### API 키 발급 방법

1. [업비트 공식 사이트](https://upbit.com) 로그인
2. 우측 상단 프로필 → **'Open API 관리'** 클릭
3. **'Open API 사용하기'** 버튼 클릭
4. 아래 권한 체크
   - ✅ 자산 조회
   - ✅ 주문 조회
   - ✅ 주문하기 ← **자동매매에 반드시 필요**
5. 허용 IP 주소 입력 (봇이 실행될 PC의 공인 IP)
6. **Access Key** 와 **Secret Key** 복사

### API 키 설정 방법

`mr3seconds_signal_bot.py` 파일 상단 **사용자 설정 영역**에 직접 입력합니다.

```python
# --------------------------------------------------------------------------
# [ 사용자 설정 영역 ]
# --------------------------------------------------------------------------
access_key = "여기에_액세스키_입력"    # 업비트 액세스 키
secret_key = "여기에_시크릿키_입력"    # 업비트 시크릿 키
```

> ⚠️ **API 키는 절대 GitHub에 올리지 마세요!**  
> 코드를 공유하거나 커밋하기 전에 반드시 API 키를 빈 문자열로 되돌려 놓으세요.

---

## ▶️ 실행 방법

API 키 설정 후 아래 명령어로 실행합니다.

```bash
python mr3seconds_signal_bot.py
```

### 실행 화면 예시

```
========================================
  Mr.3초 신호 감지 시스템 시작
========================================
✅ 업비트 연동 성공
💵 현재 KRW 잔고: 1,000,000 원

[2024-10-15 09:32:14] KRW-BTC 분석 중...
  ① 거래량 비율: 2.8배  ✅ (기준: 1.5배 이상)
  ② MACD: 골든크로스 발생  ✅
  ③ RSI: 28.4 (과매도 구간)  ✅

⭐⭐⭐ 3등급 강력 매수 신호 감지!
→ 매수 주문 실행: 100,000원
→ 진입가: 92,350,000원
→ ATR 손절가: 83,950,000원
→ 1차 익절 목표: +15% = 106,202,500원
```

---

## ⚙️ 사용자 설정 파라미터

`mr3seconds_signal_bot.py` 상단 **사용자 설정 영역**에서 모든 파라미터를 조정할 수 있습니다.

```python
# ── 거래 대상 설정 ──────────────────────────────
max_scan_tickers  = 50           # 스캔 종목 수 (API 속도 제한 방지)
timeframe         = 'minute60'   # 캔들 기준: minute60(1시간봉), minute240(4시간봉)

# ── RSI 설정 ────────────────────────────────────
rsi_period        = 14           # RSI 계산 기간
rsi_buy_level     = 30           # 과매도 기준 (30 이하 = 매수 신호)
rsi_sell_level    = 70           # 과매수 기준 (70 이상 = 매도 신호)

# ── MACD 설정 ───────────────────────────────────
macd_fast         = 12           # 단기 EMA
macd_slow         = 26           # 장기 EMA
macd_signal       = 9            # 시그널 EMA

# ── 거래량 설정 ─────────────────────────────────
volume_period     = 20           # 평균 거래량 계산 기간
volume_multiplier = 1.5          # 평균 대비 배수 기준 (1.5배 이상)

# ── ATR 손절 설정 ───────────────────────────────
atr_period        = 20           # ATR 계산 기간
atr_multiplier    = 3.0          # 손절 ATR 배수

# ── 익절 설정 ───────────────────────────────────
profit_target_1   = 0.15         # 1차 익절 +15%
profit_target_2   = 0.25         # 2차 익절 +25%
profit_target_3   = 0.40         # 3차 익절 +40%
partial_sell_ratio = 0.30        # 각 단계 매도 비율 30%

# ── 자금 관리 설정 ──────────────────────────────
initial_capital   = 1_000_000    # 초기 자본금 (원)
base_order_amount = 100_000      # 기본 1회 주문 금액 (원)
max_order_amount  = 500_000      # 최대 1회 주문 금액 (원)
max_positions     = 10           # 최대 동시 보유 종목 수
```

---

## 📊 신호 등급 기준

| 등급 | 조건 | 진입 권장 |
|------|------|-----------|
| ⭐⭐⭐ 3등급 | 거래량 ✅ + MACD 골든크로스 ✅ + RSI 과매도 ✅ | **강력 권장** |
| ⭐⭐ 2등급 | 3가지 중 2가지 충족 | 신중 검토 |
| ⭐ 1등급 | 3가지 중 1가지만 충족 | **진입 금지** |

> 📖 각 지표의 상세 분석 방법은 책 2장~5장을 참고하세요.

---

## 📄 생성 파일 안내

봇 실행 시 아래 파일이 자동으로 생성됩니다.

| 파일명 | 설명 |
|--------|------|
| `mr3seconds_bot.log` | 신호 감지 및 매매 실행 전체 로그 |
| `mr3seconds_trades.csv` | 거래 내역 CSV (일시·종목·매수매도·가격·수익률) |

---

## ⚠️ 주의사항 및 면책 고지

- 본 코드는 **교육 및 학습 목적**으로 제공됩니다.
- 자동매매는 **실제 자산 손실**이 발생할 수 있습니다.
- **처음에는 `base_order_amount`를 최소 금액(5,000원)으로 설정**하여 충분히 테스트한 후 실거래를 시작하세요.
- 업비트 API 초당 요청 제한을 초과하지 않도록 `max_scan_tickers` 설정에 주의하세요.
- 저자 및 배포자는 본 코드 사용으로 인한 투자 손실에 대해 **어떠한 책임도 지지 않습니다**.
- 투자의 최종 판단과 책임은 **본인에게 있습니다**.

---

## 📬 문의 및 업데이트

- **GitHub Issues**: 버그 리포트 및 기능 제안은 [Issues 탭](https://github.com/y-ahn/mr3seconds_signal_bot/issues)을 이용해 주세요.
- ⭐ **Star**를 눌러두시면 업데이트 소식을 받아보실 수 있습니다.

---

<p align="center">
  <b>📖 Mr.3초 신호 감지 시스템</b><br>
  RSI + MACD + 거래량으로 3초 안에 매수 신호를 포착하라
</p>
